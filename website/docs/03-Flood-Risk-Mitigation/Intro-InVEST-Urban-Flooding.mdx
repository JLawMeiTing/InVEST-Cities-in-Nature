---
id: about
title: Model Details
---

![Cover Image for the case study titled `An introduction to InVEST urban flooding model`](../../static/img/banner-image-invest-flooding.png)

:::info

This page is incomplete and we would love your help. Edit this page and add anything that would be helpful to others.

:::

## Introduction

- The InVEST Urban Flood Risk Mitigation Model calculates the runoff reduction, i.e. the amount of runoff retained per pixel compared to the storm volume. For each watershed, it also calculates the potential economic damage by overlaying information on flood extent potential and built infrastructure [(source)](https://invest-userguide.readthedocs.io/en/latest/urban_flood_mitigation.html).

## Prerequisites

- Before running the module of Urban Flood Risk Mitigation Model, you need to collect all necessary data, which has been listed in the [part of Data Requirement](https://xiaoganghe.github.io/InVEST-Cities-in-Nature/docs/Flood-Risk-Mitigation/data).

## Contents

1. [How do modules work?](#how-do-modules-work)
2. [Frequently asked questions](#frequently-asked-questions)  
3. 
## Model Output Layout

InVEST Urban Flood Risk Mitigation Model outputs have the following layout:

```
.
│  flood_risk_service.dbf
│  flood_risk_service.prj
│  flood_risk_service.shp
│  flood_risk_service.shx
│  InVEST-natcap.invest.urban_flood_risk_mitigation-log-2023-01-03--19_16_18.txt
│  precipitation=30.txt
│  Q_mm.tif
│  Runoff_retention.tif
│  Runoff_retention_m3.tif
│
├─intermediate_files
│      Q_m3.tif
│      reprojected_aoi.gpkg
│      structures_reprojected.gpkg
│
└─temp_working_dir_not_for_humans
        aligned_lulc.tif
        aligned_lulc.tif.aux.xml
        aligned_soils_hydrological_group.tif
        aligned_soils_hydrological_group.tif.aux.xml
        cn_raster.tif
        s_max.tif
        taskgraph_data.db
```  

### Structure rundown

- `/flood_risk_service.dbf` - File with results in the attribute table   
- `/flood_risk_service.prj` - File with results in the attribute table   
- `/flood_risk_service.shp` - File with results in the attribute table  
- `/flood_risk_service.shx` - File with results in the attribute table 
- `/InVEST-natcap.invest.urban_flood_risk_mitigation-log-2023-01-03--19_16_18.txt` - Each time the model is run, a text (.txt) file will be created in the Workspace. The file will list the parameter values and output messages for that run and will be named according to the service, the date and time   
- `/precipitation=30.txt`   
- `/Q_mm.tif` - Raster with runoff values (mm)  
- `/Runoff_retention.tif` - Raster with runoff retention values (no unit, relative to precipitation volume)  
- `/Runoff_retention_m3.tif` - raster with runoff retention values (in m3)
- `/intermediate_files/` 
- `/intermediate_files/Q_m3.tif` - raster with runoff values (in m3)
- `/intermediate_files/reprojected_aoi.gpkg` 
- `/intermediate_files/structures_reprojected.gpkg` 
- `/temp_working_dir_not_for_humans/` 
- `/temp_working_dir_not_for_humans/aligned_lulc.tif` 
- `/temp_working_dir_not_for_humans/aligned_lulc.tif.aux.xml` 
- `/temp_working_dir_not_for_humans/aligned_soils_hydrological_group.tif` 
- `/temp_working_dir_not_for_humans/aligned_soils_hydrological_group.tif.aux.xml` 
- `/temp_working_dir_not_for_humans/cn_raster.tif` 
- `/temp_working_dir_not_for_humans/s_max.tif` 
- `/temp_working_dir_not_for_humans/taskgraph_data.db`


### How do modules work?

- Step 1: Running the model using all materials listed in the part of Data requirement  
![figure titled `JSON about the InVEST urban flood risk mitigation model`](../../static/img/UFRM-JSON.png)  

- Step 2: The related reults when rainfall=30 mm at present land use are presneted by the following figures. According to these figures, we can find that low runoff retention values mainly exist in the urban districts (refer to [land use at present](https://xiaoganghe.github.io/InVEST-Cities-in-Nature/docs/Flood-Risk-Mitigation/data/)). Menawhile, relatively high Q values are observed in the urban districts.

|![the reults of rainfall=30 mm.](../../static/img/ufrm-30-Q.png) |
|:--:|
| Distribution of runoff values (Q) values when rainfall=30 mm. |

|![the reults of rainfall=30 mm.](../../static/img/ufrm-30-runoff-retention.png) |
|:--:|
| Distribution of runoff rention when rainfall=30 mm. |

|![the reults of rainfall=30 mm.](../../static/img/ufrm-30-Runoff-retention-values.png) |
|:--:|
| Distribution of runoff rention values when rainfall=30 mm. |

|![the reults of rainfall=30 mm.](../../static/img/ufrm-30-service.png) |
|:--:|
| Distribution of service values when rainfall=30 mm. |

- Step 3: The related reults when rainfall=100 mm at present land use are presneted by the following figures. We can find that Q values shown in these figures are clearly higher than that observed when rainfall=30 mm at present land use, indicating that higher rainfall may increase the occurency risk of high Q values.

|![the reults of rainfall=100 mm.](../../static/img/ufrm-100-Q.png) |
|:--:|
| Distribution of runoff values (Q) values when rainfall=100 mm. |

|![the reults of rainfall=100 mm.](../../static/img/ufrm-100-runoff-retention.png) |
|:--:|
| Distribution of runoff rention when rainfall=100 mm. |

|![the reults of rainfall=100 mm.](../../static/img/ufrm-100-Runoff-retention-values.png) |
|:--:|
| Distribution of runoff rention values when rainfall=100 mm. |

|![the reults of rainfall=100 mm.](../../static/img/ufrm-100-service.png) |
|:--:|
| Distribution of service values when rainfall=100 mm. |

- Step 4: The related reults when rainfall=100 mm after land use change are presneted by the following figures. We can find that obvious changes have occured in this scenario regarding to the distribution of Q and runoff retention values after comparing with the previous scenarios, which indicates that land use can play a critical role in estimating the urban flood risk mitigation (refer to [land use after change](https://xiaoganghe.github.io/InVEST-Cities-in-Nature/docs/Flood-Risk-Mitigation/data/)). 

|![the reults of rainfall=100 mm.](../../static/img/ufrm-100-Q_lulc.png) |
|:--:|
| Distribution of runoff values (Q) values when rainfall=100 mm and land use change. |

|![the reults of rainfall=100 mm.](../../static/img/ufrm-100-runoff-retention_lulc.png) |
|:--:|
| Distribution of runoff rention when rainfall=100 mm and land use change. |

|![the reults of rainfall=100 mm.](../../static/img/ufrm-100-Runoff-retention-values_lulc.png) |
|:--:|
| Distribution of runoff rention values when rainfall=100 mm and land use change. |

|![the reults of rainfall=100 mm.](../../static/img/ufrm-100-service_lulc.png) |
|:--:|
| Distribution of service values when rainfall=100 mm and land use change. |


## Glossary
| Variable              | Abbreviation       | Meaning             | Type  |
| :-------------------- | :------------------| :------------------ | :---: |
| Runoff                | Q                  | Runoff              | Output |
| Runoff retention (m<sup>3</sup>)               | \                  | runoff retention volume on pixel| Output |
| Service| \           | An indicator of the runoff retention service for the watershed. Only calculated when the Built Infrastructure Vector input is provided | Output |

## Related references
- Quagliolo C, Comino E, Pezzoli A. Experimental flash floods assessment through urban flood risk mitigation (UFRM) model: the case study of Ligurian coastal cities. Frontiers in Water. 2021 May 31;3:663378. https://doi.org/10.3389/frwa.2021.663378.  
- Kadaverugu A, Nageshwar Rao C, Viswanadh GK. Quantification of flood mitigation services by urban green spaces using InVEST model: a case study of Hyderabad city, India. Modeling Earth Systems and Environment. 2021 Mar;7(1):589-602. https://doi.org/10.1007/s40808-020-00937-0.  
- Quagliolo C, Assumma V, Comino E, Mondini G, Pezzoli A. An integrated method to assess flood risk and resilience in the MAB UNESCO Collina Po (Italy). InINTERNATIONAL SYMPOSIUM: New Metropolitan Perspectives 2022 (pp. 2545-2555). Springer, Cham. https://doi.org/10.1007/978-3-031-06825-6_243. 
